# PSXCPU

Reverse engineering of the SONY PlayStation 1 CPU (CXD8530CQ).

:warning: The information was moved from the old wiki in Russian. Information may need to be clarified here and there, and all sections will be translated to Eng.

## Обзор IC103

Центральный процессор на всех ревизиях материнских плат представлен одной большой микросхемой на 208 контактов, под индексом IC103.

|PCB|PU-7|older PU-8|newer PU-8|PU-18|PU-20|PU-22|PU-23|PM-41|PM-41(2)|
|---|---|---|---|---|---|---|---|---|---|
|IC103|![CXD8530BQ_package](/imgstore/CXD8530BQ_package.jpg)|![8530BQ_PU8_package](/imgstore/8530BQ_PU8_package.jpg)|![8530CQ_package](/imgstore/8530CQ_package.jpg)|![CXD8606AQ_package](/imgstore/CXD8606AQ_package.jpg)|![CXD8606BQ_package](/imgstore/CXD8606BQ_package.jpg)|![8606BQ_PU22_package](/imgstore/8606BQ_PU22_package.jpg)|![8606BQ_PU23_package](/imgstore/8606BQ_PU23_package.jpg)|![8606BQ_PM41_package](/imgstore/8606BQ_PM41_package.jpg)|![CXD8606CQ_package](/imgstore/CXD8606CQ_package.jpg)|
||8530BQ|8530BQ|8530CQ|8606AQ|8606BQ|8606BQ|8606BQ|8606BQ|8606CQ|
||L9A0025|L9A0025|L9A0048|L9A0082|L9B0082|L9B0082|L9B0082|L9B0082|L9A0182|

В состав центрального процессора, помимо немного измененного [ядра LSI LR33300](core.md) входят следующие компоненты:

- Cистемный сопроцессор 2 ([GTE](gte.md))
- [MDEC](mdec.md) (декодер JPEG-подобного видео)
- Контроллер DMA (DMAC) (7 каналов)
- Контроллер прерываний (INTC)
- Контролер DRAM (DRAMC)
- [Контроллер шины](bu.md) (интерфейс для ROM BIOS / GPU)
- Контроллер [SIO](sio.md) (последовательный интерфейс похожий на RS-232), на два порта (SIO0 и SIO1)
- Контроллер [PIO](pio.md) (порт расширений для дополнительных устройств)
- [Root counters](rcnt.md) (3 аппаратных счетчика)
- Встроенные кэш инструкций и кэш данных (кэш данных с возможностью прямого доступа)
- Специальные "мини-кэши" (R-buffer и W-buffer)

Микрофотография микросхемы:

![Cpu_overview](/imgstore/Cpu_overview.jpg)

Как видно большую часть микросхемы занимает "каша" из синтезированной HDL-логики, а по краям находятся различная память и регистры (см. [Кастомные блоки](custom.md)).

## Ревизии CPU

- Самые первые японские консоли (SCPH-1000 / PU-7), а также старые версии PU-8 шли с ревизией 90025.
- Потом их быстро заменили на более новые консоли (там был какой-то баг в MDEC), в которых уже стоял чип ревизии 90048
- Начиная с SCPH-5500 (PU-18) в консолях появились чипы ревизии 90082. Эти чипы стояли во всех последних моделях PSX, а также в первой версии материнок PSOne (PM-41)
- Последние версии PSOne с материнками PM-41(2) содержали чип ревизии 90182.

На этом сайте мы изучаем процессор ревизии `90048` (который стоял в SCPH-1001). Вероятно новые ревизии существенно отличаются разводкой M1/M2, поскольку чип новой ревизии "пересобирается" заново из Verilog/VHDL. Поэтому трассировать другие ревизии - это считай заново трассировать весь процессор %)

Узнать ревизию чипа можно из маркировки на крышке, убрав лишние буквы (например L9A0048 будет означать ревизию 90048). Какой-то смысл в буквах наверное есть, но скорее всего это связано с улучшением техпроцесса.

На кристалле также выбита татуировка в правом нижнем углу. Ревизия чипа указана в первой строчке:

![6f18eaaedc260890621c89afba5b0b46](/imgstore/6f18eaaedc260890621c89afba5b0b46.jpg)

## Сопутствующие микросхемы

К сопутствующим микросхемам относятся [CPU DRAM](dram.md) (оперативная память) и [BIOS ROM](bios.md).

В ранних версиях материнской платы оперативная память была представлена четырьмя модулями 8-битовой памяти. Позже она была заменена на один блок 32-битной.

![Cpu_ram_nec_424805al-a60](/imgstore/Cpu_ram_nec_424805al-a60.jpg)

## Аппаратный интерфейс

Мы будем ориентироваться на картинку из сервисного мануала по PU-22 (SCPH-7500), когда CPU был наиболее полно соединен с остальными частями.

Начиная с PU-23 (SCPH-9000) у него отобрали параллельный порт (PIO), а в PM-41 (PSOne) отобрали также и последовательный (SIO).

![CPU_Block](/imgstore/CPU_Block.jpg)
